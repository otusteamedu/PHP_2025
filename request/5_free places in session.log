SELECT
    room_place.number_row, room_place.number_place, CASE  WHEN ticket.id_session is NOT NULL THEN '1' ELSE '0' END as busy
FROM
    room_place
left join
    ticket on  room_place.id = ticket.id_room_place and ticket.id_session = 1;

1. 10_000 data

QUERY PLAN
--------------------------------------------------------------------------
 Hash Right Join  (cost=26.25..177.34 rows=900 width=40)
   Hash Cond: (ticket.id_room_place = room_place.id)
   ->  Seq Scan on ticket  (cost=0.00..151.00 rows=35 width=8)
         Filter: (id_session = 1)
   ->  Hash  (cost=15.00..15.00 rows=900 width=12)
         ->  Seq Scan on room_place  (cost=0.00..15.00 rows=900 width=12)
(6 rows)

QUERY PLAN
----------------------------------------------------------------------------------------------------------------------
 Hash Right Join  (cost=26.25..177.34 rows=900 width=40) (actual time=2.035..2.090 rows=900 loops=1)        
   Hash Cond: (ticket.id_room_place = room_place.id)
   ->  Seq Scan on ticket  (cost=0.00..151.00 rows=35 width=8) (actual time=0.291..0.291 rows=0 loops=1)    
         Filter: (id_session = 1)
         Rows Removed by Filter: 8000
   ->  Hash  (cost=15.00..15.00 rows=900 width=12) (actual time=1.739..1.739 rows=900 loops=1)
         Buckets: 1024  Batches: 1  Memory Usage: 47kB
         ->  Seq Scan on room_place  (cost=0.00..15.00 rows=900 width=12) (actual time=0.032..1.653 rows=900 loops=1)
 Planning Time: 0.121 ms
 Execution Time: 2.138 ms
(10 rows)


2. 10_000_000 data

QUERY PLAN
--------------------------------------------------------------------------------------
 Nested Loop Left Join  (cost=1000.00..579984.31 rows=3000 width=40)
   Join Filter: (room_place.id = ticket.id_room_place)
   ->  Seq Scan on room_place  (cost=0.00..50.00 rows=3000 width=12)
   ->  Materialize  (cost=1000.00..579889.31 rows=1 width=8)
         ->  Gather  (cost=1000.00..579889.31 rows=1 width=8)
               Workers Planned: 2
               ->  Parallel Seq Scan on ticket  (cost=0.00..578889.21 rows=1 width=8)
                     Filter: (id_session = 1)
 JIT:
   Functions: 10
   Options: Inlining true, Optimization true, Expressions true, Deforming true
(11 rows)


QUERY PLAN
--------------------------------------------------------------------------------------------------------------------------------------
 Nested Loop Left Join  (cost=1000.00..579984.31 rows=3000 width=40) (actual time=1753.476..1777.531 rows=3000 loops=1)
   Join Filter: (room_place.id = ticket.id_room_place)
   ->  Seq Scan on room_place  (cost=0.00..50.00 rows=3000 width=12) (actual time=0.032..0.166 rows=3000 loops=1)
   ->  Materialize  (cost=1000.00..579889.31 rows=1 width=8) (actual time=0.584..0.592 rows=0 loops=3000)
         ->  Gather  (cost=1000.00..579889.31 rows=1 width=8) (actual time=1753.394..1776.986 rows=0 loops=1)
               Workers Planned: 2
               Workers Launched: 2
               ->  Parallel Seq Scan on ticket  (cost=0.00..578889.21 rows=1 width=8) (actual time=1741.163..1741.164 rows=0 loops=3)
                     Filter: (id_session = 1)
                     Rows Removed by Filter: 16666667
 Planning Time: 0.158 ms
 JIT:
   Functions: 18
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 0.887 ms (Deform 0.353 ms), Inlining 86.442 ms, Optimization 35.296 ms, Emission 25.830 ms, Total 148.455 ms
 Execution Time: 1778.055 ms
(16 rows)


3. 10_000_000 data with index


QUERY PLAN
-----------------------------------------------------------------------------------------------    
 Hash Left Join  (cost=8.59..69.85 rows=3000 width=40)
   Hash Cond: (room_place.id = ticket.id_room_place)
   ->  Seq Scan on room_place  (cost=0.00..50.00 rows=3000 width=12)
   ->  Hash  (cost=8.58..8.58 rows=1 width=8)
         ->  Index Scan using id_ticket_by_session on ticket  (cost=0.56..8.58 rows=1 width=8)     
               Index Cond: (id_session = 1)
(6 rows)


QUERY PLAN
-----------------------------------------------------------------------------------------------------------------------------------------
 Hash Left Join  (cost=8.59..69.85 rows=3000 width=40) (actual time=0.074..2.078 rows=3000 loops=1)   Hash Cond: (room_place.id = ticket.id_room_place)
   ->  Seq Scan on room_place  (cost=0.00..50.00 rows=3000 width=12) (actual time=0.011..1.701 rows=3000 loops=1)
   ->  Hash  (cost=8.58..8.58 rows=1 width=8) (actual time=0.055..0.056 rows=0 loops=1)
         Buckets: 1024  Batches: 1  Memory Usage: 8kB
         ->  Index Scan using id_ticket_by_session on ticket  (cost=0.56..8.58 rows=1 width=8) (actual time=0.055..0.055 rows=0 loops=1)
               Index Cond: (id_session = 1)
 Planning Time: 0.105 ms
 Execution Time: 2.161 ms
(9 rows)
