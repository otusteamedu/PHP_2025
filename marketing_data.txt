CREATE VIEW marketing_data AS
SELECT
    f.title AS film,
    at.type_name AS attribute_type,
    a.name AS attribute,
    COALESCE(av.value_text, TO_CHAR(av.value_date, 'YYYY-MM-DD'), av.value_image) AS value
FROM films f
JOIN attribute_values av ON f.id = av.film_id
JOIN attributes a ON av.attribute_id = a.id
JOIN attribute_types at ON a.attribute_type_id = at.id
ORDER BY f.title, attribute_type, attribute;