# Модульные тесты

### card_number
- card_number - пустой  
возвращается ответ с кодом 400 и текстом ошибки "Номер карты должен содержать 16 цифр"
- card_number - содержит символы, отличные от цифр  
возвращается ответ с кодом 400 и текстом ошибки "Номер карты должен содержать 16 цифр"
- card_number - количество цифр отлично от 16  
возвращается ответ с кодом 400 и текстом ошибки "Номер карты должен содержать 16 цифр"

### card_holder
- card_holder - пустой  
возвращается ответ с кодом 400 и текстом ошибки "Укажите имя владельца карты"
- card_holder - содержит символы, отличные от заглавных латинских букв, пробела, дефиса  
возвращается ответ с кодом 400 и текстом ошибки "Имя владельца карты должно содержать только буквы и дефис"
- card_holder - содержит более одного пробела  
возвращается ответ с кодом 400 и текстом ошибки "Укажите имя и фамилию через один пробел"

### card_expiration
- card_expiration - пустой  
возвращается ответ с кодом 400 и текстом ошибки  "Укажите срок действия карты"
- card_expiration - формат не мм/гг  
возвращается ответ с кодом 400 и текстом ошибки "Неверный формат даты (требуется мм/гг)"
- card_expiration -  дата в прошлом  
возвращается ответ с кодом 400 и текстом ошибки "Срок действия карты истек"

### cvv
- cvv - пустой  
возвращается ответ с кодом 400 и текстом ошибки "Укажите код cvv"
- cvv - содержит символы, отличные от цифр  
возвращается ответ с кодом 400 и текстом ошибки "CVV должен содержать 3 цифры"
- cvv - количество цифр не равно трем  
возвращается ответ с кодом 400 и текстом ошибки "CVV должен содержать 3 цифры"

### order_number
- order_number - пустой  
возвращается ответ с кодом 400 и текстом ошибки "Номер заказа не может быть пустым" 
- order_number - длиннее 16 символов  
возвращается ответ с кодом 400 и текстом ошибки "Номер заказа слишком длинный"

### sum
- sum - пустой  
возвращается ответ с кодом 400 и текстом ошибки "Сумма заказа не может быть пустой"
- sum - неверный формат  
возвращается ответ с кодом 400 и текстом ошибки "Неверный формат суммы"
- sum - сумма не попадает в диапазон между минимальной и максимальной суммой оплаты  
возвращается ответ с кодом 400 и текстом ошибки "Неверное значение суммы"

### верные данные
- переданы верные данные  
осуществляется вызов сервиса А


# Интеграционные тесты

### Связка бэк - фронт
- бэк возвращает 400 (например, неверный формат номера карты)  
фронт подсвечивает поле красным и выводит текст ошибки "Номер карты должен содержать 16 цифр"
- бэк возвращает 200  
фронт показывает сообщение "Оплата прошла успешно"

### Связка бэк - сервис A
- сервис A возвращает 403  
бэк передаёт фронту ошибку "Не удалось списать средства"
- сервис A возвращает 200  
бэк вызывает метод репозитория setOrderIsPaid

### Связка бэк - репозиторий
- метод репозитория setOrderIsPaid возвращает true  
бэк возвращает 200 на фронт
- метод репозитория setOrderIsPaid выбрасывает исключение  
бэк возвращает на фронт 500 с сообщением "Ошибка обработки заказа".


# Системные тесты

### Успешная оплата
Пользователь вводит корректные данные.  
Бек валидирует и пробрасывает их в сервис А.  
Сервис A списывает деньги и возвращает ответ 200.  
Бек пробрасывает успешный ответ на фронт.
Фронт показывает "Оплата успешна".  
В БД записывается order_number и sum.

### Ошибка оплаты
Пользователь вводит корректные данные.  
Бек валидирует и пробрасывает их в сервис А.  
Сервис A возвращает 403.  
Бек пробрасывает ошибку на фронт.  
Фронт показывает сообщение "Не удалось списать средства".

### Ошибка валидации
Пользователь вводит просроченный card_expiration.  
Бэк возвращает 400 и сообщение об ошибке.  
Фронт подсвечивает поле "Срок действия" и выводит ошибку.

# Удешевление тестирования
Использование тестового магазина, тестовых карт.  
Если такой возможности нет, можно сделать мок для сервиса A.